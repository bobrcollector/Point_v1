<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="Point_v1.Views.EventDetailsPage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:converters="clr-namespace:Point_v1.Converters"
             Title="Ð¡Ð¾Ð±Ñ‹Ñ‚Ð¸Ðµ"
             BackgroundColor="{AppThemeBinding Light=#F8F9FA, Dark=#1C1C1E}">

    <Grid RowDefinitions="Auto,*,Auto">

        <!-- Ð¨Ð°Ð¿ÐºÐ° -->
        <Frame Grid.Row="0"
               BackgroundColor="#512BD4"
               Padding="15,50,15,20"
               CornerRadius="0"
               HasShadow="True">

            <Grid ColumnDefinitions="Auto,*,Auto">
                <Button Grid.Column="0"
                        Text="â†"
                        Command="{Binding GoBackCommand}"
                        BackgroundColor="Transparent"
                        TextColor="White"
                        FontSize="18"
                        WidthRequest="40"
                        HeightRequest="40"/>

                <Label Grid.Column="1"
                       Text="Ð”ÐµÑ‚Ð°Ð»Ð¸ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ"
                       TextColor="White"
                       FontSize="18"
                       FontAttributes="Bold"
                       HorizontalOptions="Center"
                       VerticalOptions="Center"/>
            </Grid>
        </Frame>
      
        <!-- ÐšÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="0">

                <!-- ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ -->
                <Frame Margin="20,20,20,0"
                       Padding="0"
                       CornerRadius="20"
                       HasShadow="True"
                       BackgroundColor="{AppThemeBinding Light=White, Dark=#2C2C2E}">

                    <VerticalStackLayout Spacing="0">
                        <BoxView BackgroundColor="#512BD4"
                                 HeightRequest="10"
                                 CornerRadius="20,20,0,0"/>

                        <VerticalStackLayout Spacing="20" Padding="25">

                            <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
                            <VerticalStackLayout Spacing="10">
                                <Label Text="{Binding Event.Title}" 
                                       FontSize="24" 
                                       FontAttributes="Bold"
                                       TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                       LineBreakMode="WordWrap"/>

                                <Frame BackgroundColor="#DFD8F7"
                                       Padding="10,6"
                                       CornerRadius="8"
                                       HasShadow="False"
                                       HorizontalOptions="Start">
                                    <Label Text="{Binding Event.CategoryId}" 
                                           FontSize="12"
                                           FontAttributes="Bold"
                                           TextColor="#512BD4"/>
                                </Frame>
                            </VerticalStackLayout>

                            <!-- Ð˜Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ -->
                            <VerticalStackLayout Spacing="15">
                                <Grid ColumnDefinitions="Auto,*">
                                    <Label Grid.Column="0" 
                                           Text="ðŸ“…" 
                                           FontSize="16"
                                           VerticalOptions="Center"/>
                                    <Label Grid.Column="1" 
                                           Text="{Binding Event.DetailedDateDisplay}" 
                                           FontSize="16"
                                           TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                           Margin="10,0,0,0"/>
                                </Grid>

                                <Grid ColumnDefinitions="Auto,*">
                                    <Label Grid.Column="0" 
                                           Text="ðŸ“" 
                                           FontSize="16"
                                           VerticalOptions="Center"/>
                                    <Label Grid.Column="1" 
                                           Text="{Binding Event.Address}" 
                                           FontSize="16"
                                           TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                           LineBreakMode="WordWrap"
                                           Margin="10,0,0,0"/>
                                </Grid>

                                <Grid ColumnDefinitions="Auto,*,Auto">
                                    <Label Grid.Column="0" 
                                       Text="ðŸ‘¥" 
                                       FontSize="16"
                                       VerticalOptions="Center"/>
                                     <Label Grid.Column="1" 
                                       Text="{Binding Event.ParticipantsDisplay}" 
                                       FontSize="16"
                                       TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                       Margin="10,0,0,0"/>

                                                               
                                     <Label Grid.Column="2" 
                                       Text="Ð’Ñ‹ ÑƒÑ‡Ð°ÑÑ‚Ð²ÑƒÐµÑ‚Ðµ"
                                       FontSize="14"
                                       TextColor="#512BD4"
                                       FontAttributes="Bold"
                                       IsVisible="{Binding IsParticipating}"/>
                                 </Grid>
                            </VerticalStackLayout>


                            <!-- ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ Ð±Ð°Ñ€ -->
                            <VerticalStackLayout Spacing="8" 
                                                IsVisible="{Binding Event.IsFull, Converter={converters:InverseBoolConverter}}">
                                <ProgressBar Progress="{Binding Event.ParticipationProgress}"
                                             ProgressColor="#512BD4"
                                             BackgroundColor="#E0E0E0"
                                             HeightRequest="6"/>
                                <Label Text="{Binding Event.ParticipantsDisplay}" 
                                       FontSize="12"
                                       TextColor="Gray"
                                       HorizontalOptions="Center"/>
                            </VerticalStackLayout>

                            <!-- Ð—Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ð¾ -->
                            <Frame IsVisible="{Binding Event.IsFull}"
                                   BackgroundColor="#FFE0E0"
                                   Padding="15"
                                   CornerRadius="10"
                                   HasShadow="False">
                                <Label Text="ðŸš« Ð’ÑÐµ Ð¼ÐµÑÑ‚Ð° Ð·Ð°Ð½ÑÑ‚Ñ‹" 
                                       TextColor="#D32F2F" 
                                       FontSize="14"
                                       FontAttributes="Bold"
                                       HorizontalOptions="Center"/>
                                
                            </Frame>

                        </VerticalStackLayout>
                    </VerticalStackLayout>
                </Frame>
                

                <!-- ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ -->
                <Frame Margin="20,15,20,0"
                       Padding="25"
                       CornerRadius="15"
                       HasShadow="True"
                       BackgroundColor="{AppThemeBinding Light=White, Dark=#2C2C2E}">

                    <VerticalStackLayout Spacing="15">
                        <Label Text="ÐžÐ¿Ð¸ÑÐ°Ð½Ð¸Ðµ" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light=Black, Dark=White}"/>

                        <Label Text="{Binding Event.Description}" 
                               FontSize="16"
                               TextColor="{AppThemeBinding Light=#333333, Dark=#CCCCCC}"
                               LineBreakMode="WordWrap"/>
                    </VerticalStackLayout>
                </Frame>

                <!-- ÐžÑ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ‚Ð¾Ñ€ -->
                <Frame Margin="20,15,20,0"
                       Padding="25"
                       CornerRadius="15"
                       HasShadow="True"
                       BackgroundColor="{AppThemeBinding Light=White, Dark=#2C2C2E}">

                    <VerticalStackLayout Spacing="15">
                        <Label Text="ÐžÑ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ‚Ð¾Ñ€" 
                               FontSize="18" 
                               FontAttributes="Bold"
                               TextColor="{AppThemeBinding Light=Black, Dark=White}"/>

                        <Grid ColumnDefinitions="Auto,*">
                            <Frame Grid.Column="0"
                                   BackgroundColor="#512BD4"
                                   Padding="15"
                                   CornerRadius="25"
                                   HeightRequest="50"
                                   WidthRequest="50"
                                   HorizontalOptions="Start">
                                <Label Text="ðŸ‘¤" 
                                       FontSize="16"
                                       HorizontalOptions="Center"
                                       VerticalOptions="Center"
                                       TextColor="White"/>
                            </Frame>

                            <VerticalStackLayout Grid.Column="1" 
                                               Spacing="5"
                                               VerticalOptions="Center"
                                               Margin="15,0,0,0">
                                <Label Text="{Binding Event.CreatorName}" 
                                       FontSize="16"
                                       FontAttributes="Bold"
                                       TextColor="{AppThemeBinding Light=Black, Dark=White}"/>
                                <Label Text="ÐžÑ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ‚Ð¾Ñ€ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ" 
                                       FontSize="14"
                                       TextColor="Gray"/>
                            </VerticalStackLayout>
                        </Grid>
                    </VerticalStackLayout>
                </Frame>

            </VerticalStackLayout>
        </ScrollView>


        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ¸ -->
        <Frame Grid.Row="2"
       BackgroundColor="{AppThemeBinding Light=White, Dark=#1C1C1E}"
       Padding="20,15"
       CornerRadius="0"
       HasShadow="True">

            <Grid ColumnDefinitions="*">
                <!-- Ð£Ð‘Ð˜Ð ÐÐ•Ðœ Ð²Ñ‚Ð¾Ñ€Ð¾Ð¹ ÑÑ‚Ð¾Ð»Ð±ÐµÑ† -->
                <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ð´Ð»Ñ Ð³Ð¾ÑÑ‚ÐµÐ¹ -->
                <Button Text="Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑƒÑ‡Ð°ÑÑ‚Ð²Ð¾Ð²Ð°Ñ‚ÑŒ"
                Command="{Binding GoToLoginCommand}"
                BackgroundColor="#512BD4"
                TextColor="White"
                FontSize="16"
                FontAttributes="Bold"
                HeightRequest="50"
                CornerRadius="10"
                IsVisible="{Binding IsGuestMode}"/>

                <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° ÑƒÑ‡Ð°ÑÑ‚Ð¸Ñ Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ñ… Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÐµÐ¹ (ÐÐ• Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ‚Ð¾Ñ€Ð¾Ð²) -->
                <Button Text="{Binding ParticipationButtonText}"
                Command="{Binding ToggleParticipationCommand}"
                BackgroundColor="{Binding ParticipationButtonColor}"
                TextColor="White"
                FontSize="16"
                FontAttributes="Bold"
                HeightRequest="50"
                CornerRadius="10"
                IsVisible="{Binding CanParticipate}"/>

                <!-- Ð¡Ð¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ‚Ð¾Ñ€Ð° -->
                <Label Text="Ð’Ñ‹ Ð¾Ñ€Ð³Ð°Ð½Ð¸Ð·Ð°Ñ‚Ð¾Ñ€ ÑÑ‚Ð¾Ð³Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ"
               FontSize="16"
               TextColor="Gray"
               HorizontalOptions="Center"
               VerticalOptions="Center"
               IsVisible="{Binding IsCreator}"/>
            </Grid>
        </Frame>
        <!-- Ð—Ð°Ð³Ñ€ÑƒÐ·ÐºÐ° -->
        <ActivityIndicator Grid.Row="1"
                         IsVisible="{Binding IsLoading}"
                         IsRunning="{Binding IsLoading}"
                         Color="#512BD4"
                         HorizontalOptions="Center"
                         VerticalOptions="Center"/>

    </Grid>
</ContentPage>