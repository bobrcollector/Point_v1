<?xml version="1.0" encoding="utf-8" ?>
<ContentPage x:Class="Point_v1.Views.ProfilePage"
             xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:Point_v1.Models"
             xmlns:converters="clr-namespace:Point_v1.Converters"
             Title="ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ">

    <ContentPage.Resources>
        <converters:IsNotNullOrEmptyConverter x:Key="IsNotNullOrEmptyConverter" />
    </ContentPage.Resources>

    <Grid RowDefinitions="Auto,*,Auto">

        <!-- Ð—Ð°Ð³Ð¾Ð»Ð¾Ð²Ð¾Ðº -->
        <Frame Grid.Row="0"
               BackgroundColor="#512BD4"
               Padding="20"
               CornerRadius="0"
               HasShadow="True">
            <Label Text="ÐŸÑ€Ð¾Ñ„Ð¸Ð»ÑŒ" 
                   TextColor="White"
                   FontSize="20"
                   FontAttributes="Bold"
                   HorizontalOptions="Center"/>
        </Frame>

        <!-- ÐšÐ¾Ð½Ñ‚ÐµÐ½Ñ‚ -->
        <ScrollView Grid.Row="1">
            <VerticalStackLayout Spacing="20" Padding="20">

                <!-- Ð“Ð¾ÑÑ‚ÐµÐ²Ð¾Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼ -->
                <VerticalStackLayout Spacing="15" 
                                   HorizontalOptions="Center" 
                                   VerticalOptions="Center"
                                   IsVisible="{Binding IsGuestMode}">

                    <Label Text="ðŸ‘¤" 
                           FontSize="40" 
                           HorizontalOptions="Center"/>

                    <Label Text="Ð’Ñ‹ Ð½Ðµ Ð°Ð²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ñ‹" 
                           FontSize="18"
                           FontAttributes="Bold"
                           HorizontalOptions="Center"/>

                    <Label Text="Ð’Ð¾Ð¹Ð´Ð¸Ñ‚Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ ÑÐ²Ð¾Ð¹ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ Ð¸ ÑÐ¾Ð·Ð´Ð°Ð²Ð°Ñ‚ÑŒ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ" 
                           FontSize="14"
                           TextColor="Gray"
                           HorizontalOptions="Center"
                           HorizontalTextAlignment="Center"/>

                    <Button Text="Ð’Ð¾Ð¹Ñ‚Ð¸ / Ð—Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒÑÑ" 
                            Command="{Binding GoToLoginCommand}"
                            BackgroundColor="#512BD4"
                            HorizontalOptions="Fill"
                            HeightRequest="50"
                            Margin="0,20,0,0"/>
                </VerticalStackLayout>

                <!-- ÐÐ²Ñ‚Ð¾Ñ€Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ -->
                <VerticalStackLayout Spacing="20"
                                   IsVisible="{Binding IsAuthenticated}">

                    <!-- ÐÐ²Ð°Ñ‚Ð°Ñ€ Ð¸ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ -->
                    <!-- ÐÐ²Ð°Ñ‚Ð°Ñ€ Ð¸ Ð¸Ð½Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ñ -->
                    <Frame Padding="20" 
       CornerRadius="15" 
       HasShadow="True"
       BackgroundColor="{AppThemeBinding Light=White, Dark=#2C2C2E}">
                        <VerticalStackLayout Spacing="15">
                            <Grid ColumnDefinitions="Auto,*">
                                <!-- ÐÐ²Ð°Ñ‚Ð°Ñ€ -->
                                <Frame Grid.Column="0"
                   BackgroundColor="#512BD4"
                   Padding="0"
                   CornerRadius="50"
                   HeightRequest="80"
                   WidthRequest="80"
                   HorizontalOptions="Start">
                                    <Image Source="{Binding AvatarImage}"
                       Aspect="AspectFill"
                       HeightRequest="80"
                       WidthRequest="80">
                                        <Image.Clip>
                                            <RoundRectangleGeometry Rect="0,0,80,80" CornerRadius="40"/>
                                        </Image.Clip>
                                    </Image>
                                </Frame>

                                <VerticalStackLayout Grid.Column="1" 
                               Spacing="8"
                               VerticalOptions="Center"
                               Margin="15,0,0,0">
                                    <Label Text="{Binding UserName}" 
                       FontSize="20"
                       FontAttributes="Bold"/>

                                    <!-- Ð“ÐžÐ ÐžÐ” - Ð¢ÐžÐ›Ð¬ÐšÐž ÐžÐ”Ð˜Ð LABEL -->
                                    <Label Text="{Binding City, StringFormat='ðŸ“ {0}'}" 
                       FontSize="14"
                       TextColor="Gray"
                       IsVisible="{Binding City, Converter={x:StaticResource IsNotNullOrEmptyConverter}}"/>

                                </VerticalStackLayout>
                            </Grid>

                            <!-- Ðž ÑÐµÐ±Ðµ -->
                            <Label Text="{Binding About}" 
               FontSize="14"
               TextColor="Gray"
               LineBreakMode="WordWrap"
               IsVisible="{Binding About, Converter={x:StaticResource IsNotNullOrEmptyConverter}}"/>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÑ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ -->
                    <!-- Ð˜Ð½Ñ‚ÐµÑ€ÐµÑÑ‹ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ -->
                    <Frame Padding="20" 
       CornerRadius="15" 
       HasShadow="True"
       BackgroundColor="{AppThemeBinding Light=White, Dark=#2C2C2E}"
       IsVisible="{Binding SelectedInterests.Count, Converter={x:StaticResource IsNotNullOrEmptyConverter}}">
                        <VerticalStackLayout Spacing="10">
                            <Label Text="ÐœÐ¾Ð¸ Ð¸Ð½Ñ‚ÐµÑ€ÐµÑÑ‹" 
               FontSize="16"
               FontAttributes="Bold"/>

                            <FlexLayout BindableLayout.ItemsSource="{Binding SelectedInterests}"
                    Direction="Row"
                    Wrap="Wrap"
                    JustifyContent="Start"
                    AlignItems="Start">

                                <BindableLayout.ItemTemplate>
                                    <DataTemplate>
                                        <!-- Ð”ÐžÐ‘ÐÐ’Ð˜Ðœ ÐžÐ¢Ð›ÐÐ”ÐžÐ§ÐÐ«Ð™ Ð¢Ð•ÐšÐ¡Ð¢ -->
                                        <Frame BackgroundColor="#DFD8F7"
                           Padding="12,6"
                           CornerRadius="12"
                           Margin="4,2"
                           HasShadow="False">
                                            <Label Text="{Binding Name}"
                               TextColor="#512BD4"
                               FontSize="12"
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               VerticalOptions="Center"/>
                                        </Frame>
                                    </DataTemplate>
                                </BindableLayout.ItemTemplate>
                            </FlexLayout>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ° -->
                    <Frame Padding="20" 
       CornerRadius="15" 
       HasShadow="True"
       BackgroundColor="{AppThemeBinding Light=White, Dark=#2C2C2E}">
                        <VerticalStackLayout Spacing="10">
                            <Label Text="Ð¡Ñ‚Ð°Ñ‚Ð¸ÑÑ‚Ð¸ÐºÐ°" 
               FontSize="16"
               FontAttributes="Bold"/>

                            <Grid ColumnDefinitions="*,*,*" 
              RowDefinitions="Auto"
              RowSpacing="10"
              ColumnSpacing="10">

                                <!-- Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹ -->
                                <Frame Grid.Column="0"
                   BackgroundColor="#E8F5E8"
                   Padding="15"
                   CornerRadius="10">
                                    <VerticalStackLayout Spacing="5">
                                        <Label Text="{Binding CreatedEventsCount}" 
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="#2E7D32"
                           HorizontalOptions="Center"/>
                                        <Label Text="Ð¡Ð¾Ð·Ð´Ð°Ð½Ð¾ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ð¹" 
                           FontSize="12"
                           TextColor="#2E7D32"
                           HorizontalOptions="Center"/>
                                    </VerticalStackLayout>
                                </Frame>

                                <!-- Ð£Ñ‡Ð°ÑÑ‚Ð²Ð¾Ð²Ð°Ð» -->
                                <Frame Grid.Column="1"
                   BackgroundColor="#E3F2FD"
                   Padding="15"
                   CornerRadius="10">
                                    <VerticalStackLayout Spacing="5">
                                        <Label Text="{Binding ParticipatedEventsCount}" 
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="#1976D2"
                           HorizontalOptions="Center"/>
                                        <Label Text="Ð£Ñ‡Ð°ÑÑ‚Ð²Ð¾Ð²Ð°Ð»" 
                           FontSize="12"
                           TextColor="#1976D2"
                           HorizontalOptions="Center"/>
                                    </VerticalStackLayout>
                                </Frame>

                                <!-- ÐŸÑ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰Ð¸Ðµ -->
                                <Frame Grid.Column="2"
                   BackgroundColor="#FFF3E0"
                   Padding="15"
                   CornerRadius="10">
                                    <VerticalStackLayout Spacing="5">
                                        <Label Text="{Binding UpcomingEventsCount}" 
                           FontSize="20"
                           FontAttributes="Bold"
                           TextColor="#F57C00"
                           HorizontalOptions="Center"/>
                                        <Label Text="ÐŸÑ€ÐµÐ´ÑÑ‚Ð¾ÑÑ‰Ð¸Ðµ" 
                           FontSize="12"
                           TextColor="#F57C00"
                           HorizontalOptions="Center"/>
                                    </VerticalStackLayout>
                                </Frame>
                            </Grid>
                        </VerticalStackLayout>
                    </Frame>

                    <!-- Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ -->
                    <Frame Padding="20" 
                           CornerRadius="15" 
                           HasShadow="True"
                           BackgroundColor="{AppThemeBinding Light=White, Dark=#2C2C2E}">
                        <VerticalStackLayout Spacing="15">
                            <Label Text="Ð”ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ" 
                                   FontSize="16"
                                   FontAttributes="Bold"/>

                            <Button Text="âœï¸ Ð ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ" 
                                    Command="{Binding EditProfileCommand}"
                                    BackgroundColor="Transparent"
                                    TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                    HorizontalOptions="Fill"
                                    BorderColor="#E0E0E0"
                                    BorderWidth="1"
                                    HeightRequest="45"/>

                            <Button Text="âš™ï¸ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸" 
                                    Clicked="OnSettingsClicked"
                                    BackgroundColor="Transparent"
                                    TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                    HorizontalOptions="Fill"
                                    BorderColor="#E0E0E0"
                                    BorderWidth="1"
                                    HeightRequest="45"/>

                            <Button Text="ðŸšª Ð’Ñ‹Ð¹Ñ‚Ð¸" 
                                    Command="{Binding SignOutCommand}"
                                    BackgroundColor="#FFE0E0"
                                    TextColor="#D32F2F"
                                    HorizontalOptions="Fill"
                                    HeightRequest="45"
                                    Margin="0,10,0,0"/>
                        </VerticalStackLayout>
                    </Frame>

                </VerticalStackLayout>

            </VerticalStackLayout>
        </ScrollView>

    </Grid>
</ContentPage>